# cbt_graphai

このリポジトリでは、**GraphAI CLI** と **GraphAI DSL** を使ったサンプルアプリケーション（CBT日記アプリ）の動作例を示します。認知行動療法（CBT）の視点でユーザーの文章を解析し、結果をコンソール上に出力する仕組みを確認できます。

---

## 1. GraphAI CLI のインストール

1. 以下のコマンドで「GraphAI クライアント」をグローバルインストールします。
   ```bash
   npm i -g @receptron/graphai_cli
   ```
2. 今いるディレクトリに **`.env` ファイル**を作成し、`OPENAI_API_KEY` を設定してください。
   ```
   OPENAI_API_KEY=sk-...
   ```
   ※ ここに記入するキーは、OpenAIから発行されたものを使用してください。

---

## 2. GraphAI DSL のインストール

次に、GraphAI DSL を使うための準備をします。  
Corepack を有効化し、Yarnを初期化した後、GraphAI DSL のCLIをインストールします。

1. Corepack の有効化
   ```bash
   corepack enable
   ```
2. Yarnプロジェクトの初期化
   ```bash
   yarn init -2
   yarn config set nodeLinker node-modules
   ```
3. GraphAI DSL CLIのインストール
   ```bash
   yarn add @graphai-dsl/cli
   ```

---

## 3. アプリの実行

1. `cbi.graphai` というDSLファイル（このリポジトリにあるサンプル）を実行する場合、以下のコマンドを実行します。
   ```bash
   yarn graphai-dsl run cbi.graphai
   ```
2. コンソール上で動作を確認できます。日記エントリーの入力を求められるので、適当な文章を入力し、エンターを押してください。

---

## 4. 出力例

以下は実行時の出力例です。

```text
% yarn graphai-dsl run cbi.graphai
? 日記エントリー：
=== CBT日記アプリへようこそ ===
日記を入力して、認知行動療法（CBT）のフレームワークで分析します。
終了するには「/終了」と入力してください。

✔ 日記エントリー： 今日の部署全体へのプレゼン、マジで調子悪かった。...
分析中...
===== CBT分析結果 =====

<自動思考>
- ネガティブな考え1（強さ: 8）: 同僚たちは内心「こいつ大丈夫か？」と思っているに違いない。
- ネガティブな考え2（強さ: 9）: プロジェクトの評価が俺のせいで下がる。
</自動思考>

<認知の歪み>
- 歪みの種類1（強さ: 8）: 心の読みすぎ（他人が自分をどう思っているかを推測する）
- 歪みの種類2（強さ: 9）: 破局的思考（最悪の結果を想定する）
</認知の歪み>

<感情と身体反応>
- 感情1（強さ: 9）: 恥ずかしさ: 胃の痛み
- 感情2（強さ: 8）: 不安: 胸の締め付け
</感情と身体反応>

<代替思考>
- より合理的な考え方1: 同僚たちが「問題なかったよ」と言ってくれたことを素直に受け取る
- より合理的な考え方2: プレゼンでミスはあったが、それがプロジェクト全体の評価に直結するわけではない
</代替思考>

<行動提案>
- 具体的な行動提案1: プレゼンを振り返り、次回に向けた改善リストを作る
- 具体的な行動提案2: 呼吸法やストレッチで身体の緊張をほぐす
</行動提案>

...（省略）...

===== 数値グラフ表示 =====
```xml
<asciiGraph>
タイトル: 感情と認知の歪みの強度分析

説明: このグラフは、ユーザーの感情と認知の歪みの強度を視覚的に示しています。

感情:
- 恥ずかしさ (強さ: 9)
  [■■■■■■■■■□]
- 不安 (強さ: 8)
  [■■■■■■■■□□]

認知の歪み:
- 心の読みすぎ (強さ: 8)
  [■■■■■■■■□□]
- 破局的思考 (強さ: 9)
  [■■■■■■■■■□]

目盛り:
  1  2  3  4  5  6  7  8  9  10
  □  □  □  □  □  □  □  □  □  □

各行は感情や認知の歪みの種類とその強度を示しています。
</asciiGraph>
```
=======================

```

このように、CBTの視点に基づいた分析結果とASCIIグラフが表示されます。

---

## 5. 注意点

- **OpenAI API Key** が必須です。`.env` に正しいキーを記入しないと動作しません。  
- 大量にトークンを消費する可能性があるので、利用時はご留意ください。  

---

## ライセンス

本リポジトリのコンテンツは、特に明示されていない限りMITライセンスです。詳細は[LICENSE](LICENSE)をご確認ください。

---

参考URL：
https://graphai-web.web.app/guide/tutorial.html

https://i-eight.github.io/graphai-dsl/
